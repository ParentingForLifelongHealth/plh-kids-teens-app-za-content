{
  "flow_type": "template",
  "flow_name": "module",
  "status": "released",
  "rows": [
    {
      "name": "active_index",
      "value": 0,
      "exclude_from_translation": true
    },
    {
      "type": "text",
      "name": "debug_active_index",
      "value": "Local active index: @local.active_index",
      "exclude_from_translation": true,
      "condition": false
    },
    {
      "name": "template_name",
      "value": "test",
      "exclude_from_translation": true
    },
    {
      "name": "join",
      "value": "_",
      "exclude_from_translation": true
    },
    {
      "name": "module_id",
      "value": "test",
      "exclude_from_translation": true
    },
    {
      "name": "articles",
      "value": "_article_tasks",
      "exclude_from_translation": true
    },
    {
      "name": "articles_data_list_name",
      "value": "@local.module_id@local.articles",
      "exclude_from_translation": true
    },
    {
      "name": "articles_data",
      "value": "@data.@local.articles_data_list_name",
      "exclude_from_translation": true
    },
    {
      "name": "show_progress_bar",
      "value": true,
      "exclude_from_translation": true
    },
    {
      "type": "begin_display_group",
      "name": "dg_progress_bar",
      "parameter_list": "sticky: top; \nstyle: background_solid;\nvariant: inline_padding;",
      "exclude_from_translation": true,
      "condition": "!!@local.show_progress_bar",
      "style_list": "padding-inline-start: 24px;"
    },
    {
      "type": "task_progress_bar",
      "name": "task_progress_bar",
      "parameter_list": "task_group_data: @local.articles_data_list_name;",
      "exclude_from_translation": true,
      "style_list": "flex: 1"
    },
    {
      "type": "round_button",
      "name": "close_button",
      "action_list": "click | emit: uncompleted",
      "parameter_list": "icon_src: close;\nvariant: no-background;",
      "exclude_from_translation": true
    },
    {
      "type": "end_display_group"
    },
    {
      "type": "begin_data_items",
      "name": "enable_dynamic_data_actions",
      "value": "@local.articles_data_list_name",
      "parameter_list": "filter: !@item.nested",
      "exclude_from_translation": true
    },
    {
      "type": "text",
      "name": "debug_loop",
      "value": "@item.id at index @item._index",
      "condition": false
    },
    {
      "type": "begin_display_group",
      "name": "only_for_active_index",
      "parameter_list": "style: column",
      "exclude_from_translation": true,
      "condition": "@item._index == @local.active_index"
    },
    {
      "name": "template_name",
      "value": "@local.module_id@local.join@item.id",
      "exclude_from_translation": true
    },
    {
      "type": "text",
      "name": "debug_temp_prefix",
      "value": "Template name: @local.template_name",
      "exclude_from_translation": true,
      "condition": false
    },
    {
      "type": "begin_display_group",
      "name": "cond_multi_art",
      "parameter_list": "style: column",
      "exclude_from_translation": true
    },
    {
      "type": "begin_template",
      "name": "article_first",
      "value": "article_@local.template_name",
      "action_list": "completed | set_item | completed: true;\ncompleted | set_item | last_completed_ts: @calc(now());\ncompleted | task: evaluate | data_list_name: module_tasks, row_id: @local.module_id;\ncompleted | set_local: active_index: @item._index  + 1;\nuncompleted | emit: uncompleted;",
      "exclude_from_translation": true,
      "condition": "@item._first"
    },
    {
      "type": "begin_nested_properties",
      "name": "article"
    },
    {
      "type": "begin_nested_properties",
      "name": "nav_buttons",
      "exclude_from_translation": true
    },
    {
      "name": "show_previous",
      "value": false,
      "exclude_from_translation": true
    },
    {
      "type": "end_nested_properties"
    },
    {
      "type": "end_nested_properties"
    },
    {
      "type": "end_template",
      "exclude_from_translation": true
    },
    {
      "type": "begin_template",
      "name": "article_middle",
      "value": "article_@local.template_name",
      "action_list": "completed | set_item | completed: true;\ncompleted | set_item | last_completed_ts: @calc(now());\ncompleted | task: evaluate | data_list_name: module_tasks, row_id: @local.module_id;\ncompleted | set_local: active_index: @item._index  + 1;\nuncompleted | set_local: active_index: @item._index  - 1;",
      "exclude_from_translation": true,
      "condition": "!@item._last && !@item._first",
      "comment": "Use different conditions to allow for conditional nav buttons and triggered actions depending on whether first, last or intermediate template.\n\nThis could be simplified once proposed data_action triggers implemented"
    },
    {
      "type": "end_template",
      "exclude_from_translation": true
    },
    {
      "type": "begin_template",
      "name": "article_last",
      "value": "article_@local.template_name",
      "action_list": "completed | set_item | completed: true;\ncompleted | set_item | last_completed_ts: @calc(now());\ncompleted | set_data | _list_id: module_tasks, _id: @local.module_id, completed: true;\ncompleted | set_data | _list_id: module_tasks, _id: @local.module_id, completed_ts: @calc(now());\ncompleted | emit: completed;\ncompleted | emit: server_sync;\nuncompleted | set_local: active_index: @item._index  - 1;",
      "exclude_from_translation": true,
      "condition": "@item._last",
      "comment": "completed | set_item | completed: true;\ncompleted | set_item | last_completed_ts: @calc(now());\ncompleted | task: evaluate | data_list_name: module_tasks, row_id: @local.module_id;\ncompleted | set_data | _list_id: module_tasks, _id: @local.module_id, completed_ts: @calc(now());\ncompleted | emit: completed;\ncompleted | emit: server_sync;\nuncompleted | set_local: active_index: @item._index  - 1;"
    },
    {
      "type": "begin_nested_properties",
      "name": "article",
      "exclude_from_translation": true
    },
    {
      "type": "begin_nested_properties",
      "name": "nav_buttons",
      "exclude_from_translation": true
    },
    {
      "name": "next_icon_src",
      "value": "@global.first_completion_icon",
      "exclude_from_translation": true
    },
    {
      "type": "end_nested_properties",
      "exclude_from_translation": true
    },
    {
      "type": "end_nested_properties",
      "exclude_from_translation": true
    },
    {
      "type": "end_template",
      "exclude_from_translation": true
    },
    {
      "type": "end_display_group",
      "exclude_from_translation": true
    },
    {
      "type": "end_display_group",
      "exclude_from_translation": true
    },
    {
      "type": "end_data_items",
      "exclude_from_translation": true
    }
  ]
}