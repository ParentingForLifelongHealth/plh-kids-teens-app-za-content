{
  "flow_type": "template",
  "flow_name": "comic_loop",
  "status": "released",
  "rows": [
    {
      "name": "article_id",
      "value": "test",
      "_translations": {
        "value": {}
      },
      "type": "set_variable",
      "_nested_name": "article_id"
    },
    {
      "type": "data_items",
      "name": "loop_comics",
      "value": "@data.comics",
      "parameter_list": {
        "filter": "@item.foreign_key == @local.article_id"
      },
      "rows": [
        {
          "type": "display_group",
          "name": "comic_element",
          "value": "comic_element",
          "rows": [
            {
              "name": "character_id",
              "value": "@item.character_id",
              "_translations": {
                "value": {}
              },
              "exclude_from_translation": true,
              "type": "set_variable",
              "_nested_name": "loop_comics.comic_element.character_id",
              "_dynamicFields": {
                "value": [
                  {
                    "fullExpression": "@item.character_id",
                    "matchedExpression": "@item.character_id",
                    "type": "item",
                    "fieldName": "character_id"
                  }
                ]
              },
              "_dynamicDependencies": {
                "@item.character_id": [
                  "value"
                ]
              }
            },
            {
              "name": "concat_character",
              "value": "characters.@local.character_id",
              "_translations": {
                "value": {}
              },
              "exclude_from_translation": true,
              "type": "set_variable",
              "_nested_name": "loop_comics.comic_element.concat_character",
              "_dynamicFields": {
                "value": [
                  {
                    "fullExpression": "characters.@local.character_id",
                    "matchedExpression": "@local.character_id",
                    "type": "local",
                    "fieldName": "character_id"
                  }
                ]
              },
              "_dynamicDependencies": {
                "@local.character_id": [
                  "value"
                ]
              }
            },
            {
              "name": "character_data",
              "value": "@data.@local.concat_character",
              "_translations": {
                "value": {}
              },
              "exclude_from_translation": true,
              "type": "set_variable",
              "_nested_name": "loop_comics.comic_element.character_data",
              "_dynamicFields": {
                "value": [
                  {
                    "fullExpression": "@data.@local.concat_character",
                    "matchedExpression": "@local.concat_character",
                    "type": "local",
                    "fieldName": "concat_character"
                  }
                ]
              },
              "_dynamicDependencies": {
                "@local.concat_character": [
                  "value"
                ]
              }
            },
            {
              "name": "character_name",
              "value": "@local.character_data.name",
              "_translations": {
                "value": {}
              },
              "exclude_from_translation": true,
              "type": "set_variable",
              "_nested_name": "loop_comics.comic_element.character_name",
              "_dynamicFields": {
                "value": [
                  {
                    "fullExpression": "@local.character_data.name",
                    "matchedExpression": "@local.character_data.name",
                    "type": "local",
                    "fieldName": "character_data"
                  }
                ]
              },
              "_dynamicDependencies": {
                "@local.character_data.name": [
                  "value"
                ]
              }
            },
            {
              "name": "character_image_asset",
              "value": "@local.character_data.image_asset",
              "_translations": {
                "value": {}
              },
              "exclude_from_translation": true,
              "type": "set_variable",
              "_nested_name": "loop_comics.comic_element.character_image_asset",
              "_dynamicFields": {
                "value": [
                  {
                    "fullExpression": "@local.character_data.image_asset",
                    "matchedExpression": "@local.character_data.image_asset",
                    "type": "local",
                    "fieldName": "character_data"
                  }
                ]
              },
              "_dynamicDependencies": {
                "@local.character_data.image_asset": [
                  "value"
                ]
              }
            },
            {
              "name": "speaker_position",
              "value": "right",
              "_translations": {
                "value": {}
              },
              "condition": "@local.character_data.role == \"caregiver\"",
              "exclude_from_translation": true,
              "type": "set_variable",
              "_nested_name": "loop_comics.comic_element.speaker_position",
              "_dynamicFields": {
                "condition": [
                  {
                    "fullExpression": "@local.character_data.role == \"caregiver\"",
                    "matchedExpression": "@local.character_data.role",
                    "type": "local",
                    "fieldName": "character_data"
                  }
                ]
              },
              "_dynamicDependencies": {
                "@local.character_data.role": [
                  "condition"
                ]
              }
            },
            {
              "name": "speaker_position",
              "value": "left",
              "_translations": {
                "value": {}
              },
              "condition": "@local.character_data.role != \"caregiver\"",
              "exclude_from_translation": true,
              "type": "set_variable",
              "_nested_name": "loop_comics.comic_element.speaker_position",
              "_dynamicFields": {
                "condition": [
                  {
                    "fullExpression": "@local.character_data.role != \"caregiver\"",
                    "matchedExpression": "@local.character_data.role",
                    "type": "local",
                    "fieldName": "character_data"
                  }
                ]
              },
              "_dynamicDependencies": {
                "@local.character_data.role": [
                  "condition"
                ]
              }
            },
            {
              "name": "variant",
              "value": "primary",
              "_translations": {
                "value": {}
              },
              "condition": "@local.character_data.role == \"caregiver\"",
              "exclude_from_translation": true,
              "type": "set_variable",
              "_nested_name": "loop_comics.comic_element.variant",
              "_dynamicFields": {
                "condition": [
                  {
                    "fullExpression": "@local.character_data.role == \"caregiver\"",
                    "matchedExpression": "@local.character_data.role",
                    "type": "local",
                    "fieldName": "character_data"
                  }
                ]
              },
              "_dynamicDependencies": {
                "@local.character_data.role": [
                  "condition"
                ]
              }
            },
            {
              "name": "variant",
              "value": "secondary",
              "_translations": {
                "value": {}
              },
              "condition": "@local.character_data.role == \"child\"",
              "exclude_from_translation": true,
              "type": "set_variable",
              "_nested_name": "loop_comics.comic_element.variant",
              "_dynamicFields": {
                "condition": [
                  {
                    "fullExpression": "@local.character_data.role == \"child\"",
                    "matchedExpression": "@local.character_data.role",
                    "type": "local",
                    "fieldName": "character_data"
                  }
                ]
              },
              "_dynamicDependencies": {
                "@local.character_data.role": [
                  "condition"
                ]
              }
            },
            {
              "name": "variant",
              "value": "gray",
              "_translations": {
                "value": {}
              },
              "condition": "@local.character_data.role == \"facilitator\"",
              "exclude_from_translation": true,
              "type": "set_variable",
              "_nested_name": "loop_comics.comic_element.variant",
              "_dynamicFields": {
                "condition": [
                  {
                    "fullExpression": "@local.character_data.role == \"facilitator\"",
                    "matchedExpression": "@local.character_data.role",
                    "type": "local",
                    "fieldName": "character_data"
                  }
                ]
              },
              "_dynamicDependencies": {
                "@local.character_data.role": [
                  "condition"
                ]
              }
            },
            {
              "type": "text_bubble",
              "name": "text_bubble",
              "value": "@item.character_text",
              "_translations": {
                "value": {}
              },
              "condition": "!!@item.character_text",
              "parameter_list": {
                "speaker_image_asset": "@local.character_image_asset",
                "speaker_name": "@local.character_name",
                "speaker_position": "@local.speaker_position",
                "variant": "@local.variant"
              },
              "exclude_from_translation": true,
              "_nested_name": "loop_comics.comic_element.text_bubble",
              "_dynamicFields": {
                "value": [
                  {
                    "fullExpression": "@item.character_text",
                    "matchedExpression": "@item.character_text",
                    "type": "item",
                    "fieldName": "character_text"
                  }
                ],
                "condition": [
                  {
                    "fullExpression": "!!@item.character_text",
                    "matchedExpression": "!@item.character_text",
                    "type": "item",
                    "fieldName": "character_text"
                  }
                ],
                "parameter_list": {
                  "speaker_image_asset": [
                    {
                      "fullExpression": "@local.character_image_asset",
                      "matchedExpression": "@local.character_image_asset",
                      "type": "local",
                      "fieldName": "character_image_asset"
                    }
                  ],
                  "speaker_name": [
                    {
                      "fullExpression": "@local.character_name",
                      "matchedExpression": "@local.character_name",
                      "type": "local",
                      "fieldName": "character_name"
                    }
                  ],
                  "speaker_position": [
                    {
                      "fullExpression": "@local.speaker_position",
                      "matchedExpression": "@local.speaker_position",
                      "type": "local",
                      "fieldName": "speaker_position"
                    }
                  ],
                  "variant": [
                    {
                      "fullExpression": "@local.variant",
                      "matchedExpression": "@local.variant",
                      "type": "local",
                      "fieldName": "variant"
                    }
                  ]
                }
              },
              "_dynamicDependencies": {
                "@item.character_text": [
                  "value"
                ],
                "!@item.character_text": [
                  "condition"
                ],
                "@local.character_image_asset": [
                  "parameter_list.speaker_image_asset"
                ],
                "@local.character_name": [
                  "parameter_list.speaker_name"
                ],
                "@local.speaker_position": [
                  "parameter_list.speaker_position"
                ],
                "@local.variant": [
                  "parameter_list.variant"
                ]
              }
            }
          ],
          "_nested_name": "loop_comics.comic_element"
        }
      ],
      "_nested_name": "loop_comics",
      "_dynamicFields": {
        "value": [
          {
            "fullExpression": "@data.comics",
            "matchedExpression": "@data.comics",
            "type": "data",
            "fieldName": "comics"
          }
        ],
        "parameter_list": {
          "filter": [
            {
              "fullExpression": "@item.foreign_key == @local.article_id",
              "matchedExpression": "@item.foreign_key",
              "type": "item",
              "fieldName": "foreign_key"
            },
            {
              "fullExpression": "@item.foreign_key == @local.article_id",
              "matchedExpression": "@local.article_id",
              "type": "local",
              "fieldName": "article_id"
            }
          ]
        }
      },
      "_dynamicDependencies": {
        "@data.comics": [
          "value"
        ],
        "@item.foreign_key": [
          "parameter_list.filter"
        ],
        "@local.article_id": [
          "parameter_list.filter"
        ]
      }
    }
  ],
  "_xlsxPath": "templates/ZA articles.xlsx",
  "_sheetsFolderUrl": "https://drive.google.com/drive/u/0/folders/1Bzlnwts9mkoLRhDy-SN5O1A3bUlBOynI"
}